
<!DOCTYPE html>
<html lang="zh">
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Airport Stock Request</title>
		<style>


			.container {
			    display: flex;
			    justify-content: center;
			    align-items: center;
			    width: 100%;
			}

			#productList label span {
			    margin-left: 8px;
			    color: #666;
			    font-size: 0.9em;
			    font-weight: normal;
			}
			.loader {
			    position: relative;
			    display: flex;
			}

			.loader span {
			    position: relative;
			    width: 50px;
			    height: 50px;
			    background: #eaeef0;
			    margin: 0 5px;
			    border: 5px solid #eaeef0;
			    border-radius: 50%;
			    box-shadow: 
			                8px 8px 15px rgba(0, 0, 0, 0.2),
			                inset 3px 3px 5px rgba(0, 0, 0, 0.1),
			                inset -1px -1px 5px rgba(255, 255, 255, 1);
			}

			.loader span::before {
			    content: "";
			    position: absolute;
			    top: 0;
			    left: 0;
			    width: 100%;
			    height: 100%;
			    background: #5c89ff;
			    border-radius: 50%;
			    box-shadow: inset 3px 3px 5px rgba(0, 0, 0, 0.1),
			                inset -1px -1px 5px rgba(255, 255, 255, 1);
			    transform: scale(0);
			    animation: animateDots 3.5s linear infinite, animateColor 5s linear infinite;
			    animation-delay: calc(var(--i) * 0.2s);
			}

			@keyframes animateDots {
			    0%, 9.99%, 70.001%
			    {
			        transform: scale(0);
			    }
			    10%, 70%
			    {
			        transform: scale(1);
			    }
			}

			@keyframes animateColor {
			    0% {
			        filter: hue-rotate(0deg);
			    }
			    100% {
			        filter: hue-rotate(360deg);
			    }
			}
									        body {
									            font-family: Arial, sans-serif;
									            padding: 15px;
									            margin: 0;
									            background-color: #FCEEDD; /* 柔和的浅灰背景 */
									            color: #333; /* 深色字体提升对比度 */
									            transition: background-color 0.3s, color 0.3s; /* 添加过渡效果 */
									        }


									        /* 黑暗模式 */
									        body.dark-mode {
									            background-color: #1c1c1c; /* 深灰色背景 */
									            color: #e0e0e0; /* 浅色字体 */
									        }

									        /* 添加一个容器类来包含目录的label */
									        .category-container {
									            display: grid;
									            grid-template-columns: repeat(3, 1fr); /* 每行3列，每列平分宽度 */
									            gap: 10px; /* 项目之间的间距 */
									            margin-bottom: 20px;
									        }

									        body.dark-mode #result {
									            background-color: #333; /* 黑暗模式下的结果框颜色 */
									            color: #e0e0e0; /* 浅色字体 */
									        }

									        body.dark-mode button {
									            background-color: #444; /* 按钮背景颜色 */
									            color: #e0e0e0; /* 按钮字体颜色 */
									        }

									        body.dark-mode .whatsapp-button {
									            background-color: #075e54; /* 深色WhatsApp绿色 */
									            color: #e0e0e0; /* 按钮字体颜色 */
									        }

									        /* 为每个商品项设置 flexbox 布局 */
									        #productList div {
									            display: flex;
									            justify-content: space-between; /* 商品名称和输入框分布两侧 */
									            align-items: center; /* 垂直居中对齐 */
									            margin-bottom: 15px; /* 保持每个商品项之间的间距 */
									        }

									        /* 商品名称部分自适应占据左边空间 */
									        #productList label {
									            flex-grow: 1; /* 自动扩展，占据可用空间 */
									            margin-right: 10px; /* 给输入框预留间距 */


									        }

									        #suggestions {
									            border: 1px solid #ccc;
									            max-height: 150px;
									            overflow-y: auto;
									            background-color: white;
									            position: absolute;
									            width: 220px;
									            z-index: 10;
									        }

									        #suggestions div {
									    padding: 4px; /* 调整上下的 padding 来减少间隔 */
									    line-height: 0.6; /* 调小 line-height 以减少上下间距 */
									    cursor: pointer;
									    color: #333; /* 设置字体颜色为深灰色 */
									}

									}


									        #suggestions div:hover {
									            background-color: #f0f0f0;
									        }

									        /* 调整输入框大小并对齐右边 */
									        input[type="number"] {
									            width: 80px;
									            margin-left: 10px;
									            text-align: right; /* 使数字靠右显示 */
									        }
									        #productSearch {
									    width: 210px; /* 调整为100%以适应容器宽度 */
									    padding: 5px; /* 增加内边距以增大点击区域 */
									    font-size: 1.2rem; /* 调整字体大小 */
									    border-radius: 5px; /* 使边框圆润 */
									    border: 1px solid #ccc; /* 设置边框颜色 */
									}

									        h1 {
									            font-size: 4rem;
									            font-weight: bold;
									            text-align: center;

									        }

									        #result {
									            width: 100%;
									            height: 150px;
									            border: 1px solid #ccc;
									            padding: 10px;
									            margin-top: 10px;
									            white-space: pre-wrap;
									            overflow: auto;
									            font-size: 1.1rem;
									            background-color: #fff;
									            border-radius: 8px;
									        }

									        div {
									            margin-bottom: 15px;
									        }

									        label {
									            font-size: 1.1rem;
									        }

									        input[type="number"], input[type="checkbox"] {
									            font-size: 1rem;
									        }

									        button {
									            padding: 12px 18px;
									            font-size: 1.1rem;
									            margin: 10px 0;
									            cursor: pointer;
									            width: 100%;
									            border: none;
									            border-radius: 8px;
									        }

									        /* WhatsApp 绿色按钮样式 */
									        .whatsapp-button {
									            background-color: #25D366; /* WhatsApp绿色 */
									            color: white; /* 白色文字 */
									        }

									        /* 切换模式按钮样式 */
									        .toggle-mode-btn {
									            background-color: #007bff;
									            color: white;
									            padding: 10px 20px;
									            margin-bottom: 20px;
									            cursor: pointer;
									            border: none;
									            border-radius: 5px;
									            font-size: 1rem;
									        }

									        .contact-info {
									            font-size: 1rem;
									            font-style: italic;
									            color: #555; /* 稍微浅一点的颜色 */
									            text-align: center;
									            background-color: #f9f9f9; /* 柔和的背景色 */
									            padding: 10px;
									            border-radius: 8px;
									            margin-bottom: 20px; /* 增加与下方内容的间距 */
									            border: 1px solid #ddd; /* 添加浅色边框 */
									        }

									        @media (max-width: 768px) {
									            h1 {
									                font-size: 3rem;
									            }

									            body {
									                padding: 10px;
									            }

									            button {
									                padding: 10px 15px;
									            }
									        }

									        .quantity-btn {
									            width: 30px;
									            height: 30px;
									            border: none;
									            border-radius: 50%; /* 圆形按钮 */
									            cursor: pointer;
									            font-size: 2rem;
									            display: inline-flex;
									            justify-content: center;
									            align-items: center;
									        }

									        .quantity-btn:nth-child(3) {
									            background-color: #4CAF50 ; /* 青色 */
									            color: white;
									        }

									        .quantity-btn:nth-child(5) {
									            background-color: #F44336; /* 红色 */
									            color: white;
									        }
						                    .quantity-btn:hover {
						    transform: scale(1.1); /* 放大按钮 */
						    transition: transform 0.2s ease; /* 添加过渡效果 */
						}
						.quantity-btn:active {
						    transform: scale(0.95); /* 按下时缩小按钮 */
						    transition: transform 0.1s ease;
						}
						.quantity-btn {
						    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
						}
						.quantity-btn {
						    transition: background-color 0.3s ease, color 0.3s ease;
						}


						                    input[type="number"] {
						    width: 40px; /* 你可以根据需要调整为任何合适的大小 */
						    padding: 5px; /* 调整内边距以使输入框看起来更舒适 */
						    margin-left: 10px;
			                margin-right: 10px;/* 留出与其他元素的间距 */
						    text-align: middle; /* 保持数字靠右对齐 */
						   }
		</style>
	</head>
	<body>
		<!-- 模式切换按钮 -->
		<button class="toggle-mode-btn" onclick="toggleDarkMode()">切换至黑暗模式</button>

		<h1>Stock Order</h1>
		<div class="container">
			<div class="loader">
				<span style="--i:0;"></span>
				<span style="--i:1;"></span>
				<span style="--i:2;"></span>
				<span style="--i:3;"></span>
				<span style="--i:4;"></span>
			</div>
		</div>
		<div>
			<input type="checkbox" id="addOnCheckbox" />
			<label for="addOnCheckbox">Add On</label>
		</div>

		<h3>SHOP</h3>
		<div>
			<label><input type="radio" name="store" value="*JKL*" onclick="toggleItems()" /> JKL</label>
			<label><input type="radio" name="store" value="*TOM*" onclick="toggleItems()" /> TOM</label>
			<label><input type="radio" name="store" value="*Ole-Ole*" onclick="toggleItems()" /> Ole-Ole</label>
		</div>

		<h3>Catogory</h3>

		<div class="category-container">
			<label><input type="radio" name="category" value="BanHeang" onclick="showCategory()" />BanHeang</label>
			<label><input type="radio" name="category" value="HopHup" onclick="showCategory()" />HopHup</label>
			<label><input type="radio" name="category" value="Chocolate" onclick="showCategory()" />Chocolate</label>
			<label><input type="radio" name="category" value="Sotong" onclick="showCategory()" />Sotong</label>
			<label><input type="radio" name="category" value="Coffee" onclick="showCategory()" />Coffee</label>
			<label><input type="radio" name="category" value="Amplang" onclick="showCategory()" />Amplang</label>
			<label><input type="radio" name="category" value="Other" onclick="showCategory()" />Other</label>
		</div>

		<input type="text" id="productSearch" placeholder="Search..." oninput="searchProduct()" autocomplete="off" />
		<div id="suggestions"></div>
		<h3>Select items (default quantity is 1）</h3>
		<div id="productList"></div>

		<button onclick="generateText()">Generate</button>
		<button class="whatsapp-button" onclick="copyAndSendWhatsApp()">Copy And Paste to WhatsApp</button>

		<div id="result"></div>

		<script>
			        const SHEET_ID = '你的表格ID';
			const SHEET_NAME = 'Sheet1'; // 如果你的表格页面名称不是 Sheet1，请修改这里

			function loadQuantitiesFromSheet() {
			    const SHEET_ID = '1QUB8R0-gtwNhdiPYU2rwFf_UKrGyyqCQHzIQ7AxKFLI';
			    const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${SHEET_NAME}`;

			    fetch(url)
			        .then(response => response.text())
			        .then(data => {
			            try {
			                const jsonData = JSON.parse(data.substr(47).slice(0, -2));
			                const rows = jsonData.table.rows;

			                // 创建一个映射来存储商品名称和库存数量
			                const stockMap = {};
			                rows.forEach(row => {
			                    if(row.c[0] && row.c[1]) {
			                        const productName = row.c[0].v;
			                        const stockQuantity = row.c[1].v;
			                        stockMap[productName] = stockQuantity;
			                    }
			                });

			                // 更新所有商品标签显示库存数量
			                const labels = document.querySelectorAll('#productList label');
			                labels.forEach(label => {
			                    const productName = label.textContent;
			                    const stock = stockMap[productName];
			                    if (stock !== undefined) {
			                        // 在商品名称后添加库存数量
			                        label.innerHTML = `${productName} <span style="color: blue; font-size: 0.9em;">(Stock: ${stock})</span>`;
			                    }
			                });
			            } catch (error) {
			                console.error('解析数据错误:', error);
			            }
			        })
			        .catch(error => console.error('获取数据失败:', error));
			}
						        // 分类商品
						        const categories = {
			    BanHeang: [
			        { id: 101, name: "BH Tambun Original" },
			        { id: 102, name: "BH Tambun Pandan" },
			        { id: 103, name: "BH Tambun White Lotus" },
			        { id: 104, name: "BH Tau Sar Pheah" },
			        { id: 105, name: "BH Heong Pheah" },
			        { id: 106, name: "BH Beh Teh Saw" },
			        { id: 107, name: "BH Phong Pheah" },
			        { id: 108, name: "BH Pepper Biscuit" },
			        { id: 109, name: "BH Hup Toh Soh" },
			        { id: 110, name: "BH Omlette Crisp Chocolate" },
			        { id: 111, name: "BH Omlette Crisp Pandan" },
			        { id: 112, name: "BH Kai Chai Biscuit" },
			        { id: 113, name: "BH Almond Slice" },
			        { id: 114, name: "BH Almond Slice Salted Egg" },
			        { id: 115, name: "BH Durian Crisp" },
			        { id: 116, name: "BH Coconut Crisp" },
			        { id: 117, name: "BH Salted Fish Crisp" },
			        { id: 118, name: "BH Salted Egg Crisp" },
			        { id: 119, name: "BH Cheese Crisp" },
			        { id: 120, name: "BH Chic Kut Teh" },
			        { id: 121, name: "BH Ginger Slice" },
			        { id: 122, name: "BH Dried Mango" },
			        { id: 123, name: "BH Kacang Tumbuk" },
			        { id: 124, name: "BH Gula Kacang" },
			        { id: 125, name: "BH Black Sesame Peanut" },
			        { id: 126, name: "BH Shat Kek Ma" },
			        { id: 127, name: "BH Shat Kek Ma (Brown Sugar)" },
			        { id: 128, name: "BH Coconut Biscuits" },
			        { id: 129, name: "BH FD Durian 50g" },
			        { id: 130, name: "BH FD Mango 50g" },
			        { id: 131, name: "BH FD Durian 30g" },
                    { id: 160, name: "BH FD Mango 30g" },
                    { id: 161, name: "BH FD Cempedak 25g" },
                    { id: 162, name: "BH FD Jackfruit 30g" },
			        { id: 132, name: "BH Butter Cookies" },
			        { id: 133, name: "BH Chocolate Cookies" },
			        { id: 134, name: "BH Raisin Cookies" },
			        { id: 135, name: "BH Almond Cookies" },
			        { id: 136, name: "BH Pineapple Tart" },
			        { id: 137, name: "BH Red Bean Mochi" },
			        { id: 138, name: "BH Peanut Mochi" },
			        { id: 139, name: "BH Green Tea Mochi" },
			        { id: 140, name: "BH Durian Mochi" },
			        { id: 141, name: "BH Yam Mochi" },
			        { id: 142, name: "BH Mochi Milk Yam Filling" },
			        { id: 143, name: "BH Mochi Milk Mango Filling" },
			        { id: 144, name: "BH Mochi Milk Green Tea" },
			        { id: 145, name: "BH Sotong Cuttlefish" },
			        { id: 146, name: "BH Gula Cuttlefish" },
			        { id: 147, name: "BH Satay Fish" },
			        { id: 148, name: "BH Fillet Cracker With Anchovy" },
			        { id: 149, name: "BH Fillet Cracker With Seaweed" },
			        { id: 150, name: "BH Sakura Shrimp" },
			        { id: 151, name: "BH Frugurt Yogurt Blueberry" },
			        { id: 152, name: "BH Frugurt Yogurt Peach" },
			        { id: 153, name: "BH Frugurt Yogurt Mango" },
			        { id: 154, name: "BH Durian Pudding" },
			        { id: 155, name: "BH Coconut Pudding" },
			        { id: 156, name: "BH Dodol Durian" },
			        { id: 157, name: "BH Dodol Coconut" },
			        { id: 158, name: "BH Dodol Pandan" },
			        { id: 159, name: "BH Durian Beh Teh Saw" },
                    { id: 163, name: "Fruity Marshmallow" },
                    { id: 164, name: "Matcha Marshmallow" },
                    { id: 165, name: "Durian Marshmallow" },
			    ],
			    HopHup: [
			        { id: 201, name: "HT Durian Tart" },
			        { id: 202, name: "HT Mango Tart" },
			        { id: 203, name: "HT Durian Wafer Roll" },
			        { id: 204, name: "HT Mango Wafer Roll" },
			        { id: 205, name: "HT Omelette Durian" },
			        { id: 206, name: "HT Coconut Ori Cookies" },
			        { id: 207, name: "HT Coconut Pandan Cookies" },
			        { id: 208, name: "HT Dodol Original" },
			        { id: 209, name: "HT Dodol Kopi" },
			        { id: 210, name: "HT Dodol Durian" },
			        { id: 211, name: "HT Freeze Dried Mango" },
			        { id: 212, name: "HT Freeze Dried Durian" },
			        { id: 213, name: "Salted Egg Fish Skin" },
			        { id: 214, name: "Salted Egg Fish Skin Spicy" },
			        { id: 215, name: "Salted Egg Salmon Skin" },
			        { id: 216, name: "Musang King Durian Candy" },
			        { id: 217, name: "HT Durian Cookies" },
			        { id: 218, name: "Fish Chips Classic" },
			        { id: 219, name: "Salted Egg Fish Chips" },
			        { id: 220, name: "Salted Egg Fish Chips Mala" }
			    ],
			    Chocolate: [
			        { id: 301, name: "AD Chocolate Durian", unit: 'pc', defaultQuantity: 50 },
			        { id: 302, name: "AD Chocolate Sabah Tea", unit: 'pc', defaultQuantity: 50 },
			        { id: 303, name: "AD Chocolate Mango", unit: 'pc', defaultQuantity: 50 },
			        { id: 304, name: "AD Chocolate Chili", unit: 'pc', defaultQuantity: 50 },
			        { id: 305, name: "AD Chocolate Dark", unit: 'pc', defaultQuantity: 50 },
			        { id: 306, name: "AD Chocolate Coffee", unit: 'pc', defaultQuantity: 50 },
			        { id: 307, name: "AD Chocolate Banana", unit: 'pc', defaultQuantity: 50 },
			        { id: 308, name: "AD Chocolate Tiramisu", unit: 'pc', defaultQuantity: 50 },
			        { id: 309, name: "AD Chocolate Mint", unit: 'pc', defaultQuantity: 50 },
			        { id: 310, name: "AD Chocolate Rambutan", unit: 'pc', defaultQuantity: 50 },
			        { id: 311, name: "AD Chocolate Soursup", unit: 'pc', defaultQuantity: 50 },
			        { id: 312, name: "AD Chocolate Coconut", unit: 'pc', defaultQuantity: 50 },
			        { id: 313, name: "AD Chocolate Mangosteen", unit: 'pc', defaultQuantity: 50 }
			    ],
			    Sotong: [
			        { id: 401, name: "Cuttlefish Red" },
			        { id: 402, name: "Cuttlefish Lemon" },
			        { id: 403, name: "Cuttlefish Honey" },
			        { id: 404, name: "Cuttlefish Floss Original" },
			        { id: 405, name: "Cuttlefish Massive" },
			        { id: 406, name: "Cuttlefish Whole" },
			        { id: 407, name: "Cuttlefish Roasted" },
			        { id: 408, name: "Cuttlefish Chili" },
			        { id: 409, name: "Cuttle Fish Slices" },
			        { id: 410, name: "Cuttle Fish Sugar" },
			        { id: 411, name: "Five Star Cuttlefish" }
			    ],
			    Coffee: [
			        { id: 501, name: "BH W/Coffee(Mini)" },
			        { id: 502, name: "BH W/Coffee(Mini)No Sugar" },
			        { id: 503, name: "BH Durian W/Coffee(Mini)" },
			        { id: 504, name: "BH Teh Tarik(Mini)" },
			        { id: 505, name: "BH W/Coffee" },
			        { id: 506, name: "BH W/Coffee No Sugar" },
			        { id: 507, name: "BH Kopi O 2in1" },
			        { id: 508, name: "BH Kopi O No Sugar" },
			        { id: 509, name: "BH Teh Tarik" },
			        { id: 510, name: "BH Durian White Coffee" },
			        { id: 511, name: "Kopi Tenom Silver" },
			        { id: 512, name: "Kopi Tenom Gold" },
			        { id: 513, name: "Kopi Tenom Blue" },
			        { id: 514, name: "Kopi Tenom Green" },
			        { id: 515, name: "Kopi Tenom Red" }
			    ],
			    Am
